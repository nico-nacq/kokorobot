<!DOCTYPE html><html lang='en'><head><meta charset='utf-8'><meta name='description' content='Kokorobot is the virtual playground of cartoonist Rek Bellum.'><meta name='viewport' content='width=device-width, initial-scale=1.0'><meta name='twitter:card' content='summary'><meta name='twitter:site' content='@hundredrabbitss'><meta name='twitter:title' content='Kokorobot'><meta name='twitter:description' content='Kokorobot is the virtual playground of cartoonist Rek Bellum.'><meta name='twitter:creator' content='@hundredrabbits'><meta name='twitter:image' content='http://kokorobot.ca/media/services/icon.jpg'><meta property='og:title' content='kokorobot'><meta property='og:type' content='article'><meta property='og:url' content='http://kokorobot.ca/'><meta property='og:image' content='https://kokorobot.ca/media/services/icon.jpg'><meta property='og:description' content='Kokorobot is the virtual playground of cartoonist Rek Bellum.'><meta property='og:site_name' content='kokorobot'><link rel='icon' type='image/x-icon' href='../media/services/favicon.ico'><link rel='icon' type='image/png' href='../media/services/icon.jpg'><link rel='apple-touch-icon' href='../media/services/apple-touch-icon.png' /><title>Kokorobot — pandoc</title><link rel='stylesheet' type='text/css' href='../links/main.css'></head><body><header><h1><a href='home.html'>Rek Bellum</a></h1><h2><a href='home.html'>⬟</a></h2><ul><li><a class='about' href='about.html'>About</a></li><li><a class='projects' href='projects.html'>Projects</a></li><li><a class='illustration' href='illustration.html'>Illustration</a></li><li><a class='stories' href='stories.html'>Stories</a></li><li><a class='store' href='store.html'>Store</a></li><li><a class='characters' href='characters.html'>Characters</a></li><li><a class='notes' href='notes.html'>Notes</a></li></ul></header><main class='pandoc'><h3><a id='content'>Contents</a></h3>

<ul>
	<li><a href='#whatispandoc'>What is Pandoc?</a></li>
	<li><a href='#markdown'>Pandoc Markdown</a></li>
	<li><a href='#install'>Installing Pandoc</a></li>
	<li><a href='#latex'>Installing XeLaTeX, LaTeX</a></li>
	<li><a href='#txtpdf'>From Markdown to PDF</a></li>
	<li><a href='#extensions'>Using Pandoc Markdown Extensions</a></li>
	<li><a href='#papersize'>Changing papersize</a></li>
	<li><a href='#addext'>Adding Extensions</a></li>
	<li><a href='#bookcover'>Book cover for PDF</a></li>
	<li><a href='#epub'>Making Epubs</a></li>
	<li><a href='#mobi'>Mobi conversion</a></li>
</ul>

<h3><a id='whatispandoc'>What is Pandoc?</a></h3>

<p><a href='https://pandoc.org/index.html' target="_blank">Pandoc</a> is a terminal utility that converts files from one markup format into another. You can convert an HTML page to Markdown, Markdown to PDF, Markdown to EPUB etc. It's a useful tool to create articles, scientific papers, and books.</p>

<p>When generating PDFs, Pandoc's use of <a href='https://www.latex-project.org/' target="_blank">LaTeX</a> (a document preparation system) encourages authors not to worry too much about the appearance of their documents but to concentrate on getting the right content.</p> 

<p>This is a list of notes I've compiled when came time to learn how to generate PDFs with Pandoc. This guide was made and tested on the <a href='https://elementary.io' target="_blank">Elementary</a> Linux distribution. It is for people with limited command-line experience.</p>

<h3><a id='markdown'>Pandoc Markdown</a></h3>

<p>Make sure that the file you want turned into a PDF has a <b>.txt</b> or <b>.md</b> (if you want syntax highlighting) extension, and take note of the path to your project file, as you'll need that to generate your PDF later. The next step is to add Pandoc Markdown syntax to the text.</p>

<p><a href='https://rmarkdown.rstudio.com/authoring_pandoc_markdown.html%23raw-tex' target="_blank">Pandoc Markdown</a> is an extended and slightly revised version of John Gruber’s <a href='https://daringfireball.net/projects/markdown/' target="_blank">Markdown syntax</a>. Markdown is a simple, and easy-to-use markup language to format plain-text content. This language is used to annotate a document in a way that is syntactically distinguishable from the text.</p>

<p>For example, to make text <b>bold</b>, add two asterisks on each side of the word:</p>

<pre>In January 2016, we bought our first sailboat, a **Yamaha 33**.</pre>

<p>Hash symbols preceding a word or phrase make a heading. Be sure to add a space between the hash and the first word:</p>

<pre>## Introduction</pre>

<img src="../media/interface/markdown.jpg" loading='lazy' class='tools'>

<p>One hash would make the title bigger, three would make the heading smaller, four even smaller, five even smaller etc.</p>

<p>Once your text file has Markdown syntax, it is time to install Pandoc.</p>

<h3><a id='install'>Installing Pandoc on Linux</a></h3>

<p>To install pandoc on Linux, you can generally use your package manager, or download the <a href='https://github.com/jgm/pandoc/releases/tag/2.11.2' target="_">latest version</a> from the website directly. You'll want to get <b>pandoc-2.11.2-linux-amd64.tar.gz</b>. When you've downloaded it, unzip the file, and move the folder (named pandoc-x.xx.x) to your Applications folder.</p>

<p>You've got Pandoc, but it's not usable yet. You've got to use the terminal to 'unpack' the files. Write the path to Pandoc package, followed by the sudo command:</p>

<pre>cd ~/Applications
sudo dpkg -i ./pandoc-2.11.1
</pre>

<p>You'll be asked for your <b>password</b>. Enter your password, and press enter to install Pandoc.</p>

<p>You should have the latest version of Pandoc installed, to verify the version, type the following in the command line:</p>

<pre>pandoc --version</pre>

<p>You'll see the name of the version on top, which in this case, is version <b>2.11.1.</b></p>

<pre>pandoc 2.11.2
Compiled with pandoc-types 1.22, texmath 0.12.0.3, skylighting 0.10.0.3,
citeproc 0.2, ipynb 0.1.0.1
User data directory: /home/user/.local/share/pandoc or /home/user/.pandoc
Copyright (C) 2006-2020 John MacFarlane. Web:  https://pandoc.org
This is free software; see the source for copying conditions. There is no
warranty, not even for merchantability or fitness for a particular purpose.
</pre>

<p>You now have Pandoc installed on your computer.</p>

<h3><a id='latex'>Installing Tex Live</a></h3>

<p>For converting text files (written in Pandoc Markdown) to PDF, Pandoc makes use of LaTeX and XeTeX as the rendering engine. This is what will make your documents beautiful. Tex Live is a package specific to Linux, enter the following command to install it:</p>

<pre>sudo apt-get install texlive-xetex texlive-fonts-recommended texlive-generic-recommended</pre>

<h3><a id='txtpdf'>From Markdown to pdf</a></h3>

<p>To generate a PDF from your <b>.md</b> or <b>.txt</b> file, locate your project file using the terminal. Use <b>cd</b> to navigate to your project folder. The example below is if you'd saved your project file to Documents, under a folder named "myproject". Remember, caps matter when using <b>cd</b>:</p>

<pre>cd Documents/myproject/</pre>

<p>Enter the following command, replacing "filename" with the name of your project file, and "filename_export" with for the final exported PDF file:</p>

<pre>pandoc filename.txt --pdf-engine=xelatex -o filename_export.pdf</pre>

<p>In that same folder where you had your .txt file saved, you'll find your Pandoc-generated PDF!</p>

<h3><a id='extensions'>Using Pandoc Markdown Extensions</a></h3>

<p>In Pandoc, you can use Extensions (see below) to specify the output of your PDF more granularly, say if you want to change the paper size, add tables or footnotes etc.</p>

<h3><a id='papersize'>Changing papersize</a></h3>

<p>By default, the Pandoc PDF format is a4. If you want to change it, you'll have to add the following when generating the PDF in the command line:</p>

<pre>--variable=geometry:a5paper</pre>

<p>Appended with the rest, to generate the PDF from a Markdown file, it'll look like this:</p>

<pre>pandoc --variable=geometry:a5paper filename.txt --pdf-engine=xelatex -o filename_export.pdf</pre>

<p>If you're file is a <b>.md</b>, change the extension of your project file.</p>

<h3><a id='addext'>Adding extensions</a></h3>

<p>If you want add tables, you'll have to add an Extension. Extensions are specified in the command line when generating a PDF. In the example below, after <b>-- from markdown</b>, I've added a <b>+</b> followed by the extension <b>simple tables</b>. If the extension name has two words, adding an underscore between them is necessary.</p>

<pre>--from markdown+simple_tables</pre>

<p>You can add more extensions, adding a <b>+</b> inbetween each one. In the example below, I've added both <b>simple tables</b> and <b>citations</b>.</p>

<pre>--from markdown+simple_tables+citations</pre>

<p>Below is an example of a terminal command for a PDF generated from a .txt file, in a5 format, with the simple tables extension.</p>

<pre>pandoc --variable=geometry:a5paper filename.txt --pdf-engine=xelatex --from markdown+simple_tables -o filename_export.pdf</pre>

<h3><a id='bookcover'>Book cover PDF</a></h3>

<p>Adding a book cover for a PDF with pandoc is not straightforward, or maybe there is something I am missing? I could not figure out how to add images as full-page covers, BUT—I found a workaround to do it...and again, another big BUT! It requires the download, and installation of <a href='https://imagemagick.org/index.php' target="_blank">ImageMagick</a>.</p>

<p>If you don't have ImageMagick, I highly recommend it. It's great to create, edit, compose, or convert digital images in tons of formats. We will use ImageMagick to convert the cover image into a pdf, which in turn, we will combine together into yet another pdf.</p>

<p>Once you've installed ImageMagick, save your cover image in your project folder. If you put it in a seperate folder, be sure to specify it. Now, use this ImageMagick command to convert the image to a pdf:</p>

<pre>convert cover.jpg cover.pdf</pre>

<p>To combine the cover pdf with the main text pdf use the following command, note that the combined.pdf is the name of your final, merged pdf:</p>

<pre>pdfunite cover.pdf filename.pdf combined.pdf</pre>

<h3><a id='epub'>Making epubs</a></h3>

<p>Epub is a popular ebook format, but if you convert your markdown file it may break some of your formatting. For example, Epubs ignore the <b>\newpage</b> Markdown tag, but adding a page break to a header with css fixes that problem. It's possible to control the final look of the document with css. First step is to create a blank text file, and to save it as <b>epub.css</b>.</p>

<p>I prefer not to modify the look too much, so I keep my css to minimum. For example:</p>

<pre>
body {font-size: 14px}
table {font-size: 14px}
h4 {page-break-before: always;}
h2 {page-break-before: always;}
blockquote {font-style: italic;}
img { max-width: 100% }
</pre>

<p>I don't recommend setting a fixed font size like in the example above, as the font may be too small to read on a phone. I specified a max width for images otherwise they have a tendency to spill out of the page. Of course, these are only a few of the many things one can do to improve the look of documents with css.</p>

<p>When exporting the file as an epub with pandoc, add the extension like the above example, and with it, arguments to generate a table of contents from your list of headers, the book's metadata, a book cover and your css file.</p> 

<p><b>Table of Contents:</b> To change the name of the table of the contents generated by Pandoc, add the command:</p>

<pre>-V toc-title:"Custom text"</pre>

<p>If the table of contents depth is not specified, it defaults to 3 (level 1, 2 and 3 headers will be included in the generated table of contents). To keep the table to a depth of level 2, add:</p>

<pre>--toc-depth=2</pre>

<p><b>Metadata file:</b> A metadata file includes all the author, rights and publishing information. Create a new file and save it as <b>metadata.yaml</b>. Then, add the following:</p>

<pre>
---
title:
- type: main
  text: Book title
- type: subtitle
  text: My sub book title (if any)
creator:
- role: author
  text: Your name
publisher: Your publisher's name
lang: en-CA
rights: © 2021 MyCompany, *your chosen license*
table-of-contents: true
...
</pre>

<p>The text in the .yaml file need to be delimited by a line of three hyphens (---) at the top and a line of three hyphens (---) or three dots (...) at the bottom. Metadata will be taken from the fields of the YAML object and added to any existing document metadata. See more about <a href='https://pandoc.org/MANUAL.html#metadata-blocks' target="_blank">metadata files</a>. Next, pass it to pandoc as an argument:</p>

<pre>--epub-metadata=metadata.yaml</pre>

<p><b>Book cover</b>: To add a cover, save the file to the folder with the rest of your text, and pass it to pandoc as an argument:</p>

<pre>--epub-cover-image=cover.jpg</pre>

<p>

<p>The final pandoc command to convert a file from Markdown to Epub would look like this (with variations, depending on the extensions you choose):</p>

<pre>~pandoc filename.md --from markdown+simple_tables+line_blocks --toc -V toc-title:"Table of Contents" --toc-depth=2 --epub-metadata=metadata.yaml --epub-cover-image=cover.jpg --css epub.css -w epub -o filename.epub</pre>

<p>Test your book on a variety of devices before publishing it.</p>

<h3><a id='mobi'>Mobi</a></h3>

<p>Pandoc cannot convert files to Mobi, but it's possible to convert an Epub to Mobi using Calibre. To start, make an Epub (steps above). Then, <a href='https://calibre-ebook.com/download' target="_">download</a> and install Calibre.</p>

<p>Once Calibre is installed, run the following command in the terminal:</p>

<pre>ebook-convert input_file output_file</pre>

<p>input_file is the input and output_file is the output. Both must be specified as the first two arguments to the command. It's possible to add more options to further change the look of the output file. There are too many options to name here, but all are listed <a href='https://manual.calibre-ebook.com/generated/en/ebook-convert.html' target='_blank'>here</a>.</p>

<p>Calibre doubles as a book viewer, so you can test your book on that. Note that like with an Epub, test the file on as many devices as you can.</p>

<p>Now, all that's left is to publish your e-book! I personally choose not to sell on Amazon, and publish on <a href='https://itch.io/' target="_blank">itch.io</a>. There are no publishing fees, and with it, it's possible to automate uploads using <a href='https://itch.io/docs/butler/' target="_blank">Butler</a> (itch.io's command line tools) if say, you want to publish changes to your book fast. If anyone is interested in me writing about this let me know, and I will. Also, if you've read this, and have questions don't hesitate to <a href='rek.html#contact'>ask me</a>! I'll do my best to help.</p>

<img src='../media/interface/pandocpdf.png' loading='lazy' class="tools">
</main><footer><p><a href='about.html'>Rek Bellum </a> © 2021 <a href='https://creativecommons.org/licenses/by-nc-sa/4.0/'>BY-NC-SA 4.0</a> <a href='http://webring.xxiivv.com/#random'>Webring</a> <a href='https://github.com/rekkabell/kokorobot'>Github</a> <a href='https://merveilles.town/@rek'>Mastodon</a></p></footer></body></html>